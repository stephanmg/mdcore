\hypertarget{engine_8c}{\section{/home/stephan/code/unversioned/mdcore-\/0.1.7/src/engine.c File Reference}
\label{engine_8c}\index{/home/stephan/code/unversioned/mdcore-\/0.\-1.\-7/src/engine.\-c@{/home/stephan/code/unversioned/mdcore-\/0.\-1.\-7/src/engine.\-c}}
}
{\ttfamily \#include $<$stdlib.\-h$>$}\\*
{\ttfamily \#include $<$stdio.\-h$>$}\\*
{\ttfamily \#include $<$pthread.\-h$>$}\\*
{\ttfamily \#include $<$math.\-h$>$}\\*
{\ttfamily \#include $<$float.\-h$>$}\\*
{\ttfamily \#include $<$string.\-h$>$}\\*
{\ttfamily \#include \char`\"{}../config.\-h\char`\"{}}\\*
{\ttfamily \#include $<$omp.\-h$>$}\\*
{\ttfamily \#include \char`\"{}cycle.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}errs.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}fptype.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}lock.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}part.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}cell.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}task.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}queue.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}space.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}potential.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}runner.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}bond.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}rigid.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}angle.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}dihedral.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}exclusion.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}reader.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}engine.\-h\char`\"{}}\\*
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{engine_8c_a7673862d447029edaf3172ebd94aa28e}{error}(\hyperlink{errs_8c_a7441ef0865bcb3db9b8064dd7375c1ea}{id})~( \hyperlink{engine_8h_a3724bd1c34d31c4ff37eaff52dc0a580}{engine\-\_\-err} = \hyperlink{errs_8h_ae37a9c0e0a0aa4a92dbe64c0f38ed95c}{errs\-\_\-register}( \hyperlink{errs_8c_a7441ef0865bcb3db9b8064dd7375c1ea}{id} , \hyperlink{engine_8h_aa489083c5e5d436bafd05a7860b21804}{engine\-\_\-err\-\_\-msg}\mbox{[}-\/(\hyperlink{errs_8c_a7441ef0865bcb3db9b8064dd7375c1ea}{id})\mbox{]} , \-\_\-\-\_\-\-L\-I\-N\-E\-\_\-\-\_\- , \-\_\-\-\_\-\-F\-U\-N\-C\-T\-I\-O\-N\-\_\-\-\_\- , \-\_\-\-\_\-\-F\-I\-L\-E\-\_\-\-\_\- ) )
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{engine_8c_aee24cd486d7bc6be737df5ecd43cd68b}{engine\-\_\-shuffle} (struct \hyperlink{structengine}{engine} $\ast$\hyperlink{potential__eval_8h_ac54d1391e6657558123088943f721021}{e})
\begin{DoxyCompactList}\small\item\em Re-\/shuffle the particles in the engine. \end{DoxyCompactList}\item 
int \hyperlink{engine_8c_ad67df51519859e9386275e0cc084f840}{engine\-\_\-timers\-\_\-reset} (struct \hyperlink{structengine}{engine} $\ast$\hyperlink{potential__eval_8h_ac54d1391e6657558123088943f721021}{e})
\begin{DoxyCompactList}\small\item\em Set all the engine timers to 0. \end{DoxyCompactList}\item 
int \hyperlink{engine_8c_a83702eb8b53c1de5addc229530571f1e}{engine\-\_\-verlet\-\_\-update} (struct \hyperlink{structengine}{engine} $\ast$\hyperlink{potential__eval_8h_ac54d1391e6657558123088943f721021}{e})
\begin{DoxyCompactList}\small\item\em Check if the Verlet-\/list needs to be updated. \end{DoxyCompactList}\item 
int \hyperlink{engine_8c_a58eed0f9b4140be350b08e1742627f87}{engine\-\_\-split} (struct \hyperlink{structengine}{engine} $\ast$\hyperlink{potential__eval_8h_ac54d1391e6657558123088943f721021}{e})
\begin{DoxyCompactList}\small\item\em Set-\/up the engine for distributed-\/memory parallel operation. \end{DoxyCompactList}\item 
int \hyperlink{engine_8c_af88982963377c8df684162bda505fe9d}{engine\-\_\-split\-\_\-\-M\-E\-T\-I\-S} (struct \hyperlink{structengine}{engine} $\ast$\hyperlink{potential__eval_8h_ac54d1391e6657558123088943f721021}{e}, int N, int flags)
\begin{DoxyCompactList}\small\item\em Split the computation domain over a number of nodes using M\-E\-T\-I\-S graph partitioning. \end{DoxyCompactList}\item 
int \hyperlink{engine_8c_ad8e0c8513f4fbf6fc18f3166b4484044}{engine\-\_\-split\-\_\-bisect} (struct \hyperlink{structengine}{engine} $\ast$\hyperlink{potential__eval_8h_ac54d1391e6657558123088943f721021}{e}, int N)
\begin{DoxyCompactList}\small\item\em Split the computational domain over a number of nodes using bisection. \end{DoxyCompactList}\item 
int \hyperlink{engine_8c_aec725cc5cea5de5ab0cfd4649acee54b}{engine\-\_\-flush} (struct \hyperlink{structengine}{engine} $\ast$\hyperlink{potential__eval_8h_ac54d1391e6657558123088943f721021}{e})
\begin{DoxyCompactList}\small\item\em Clear all particles from this \hyperlink{structengine}{engine}. \end{DoxyCompactList}\item 
int \hyperlink{engine_8c_a55d13cd5411d205e44e0b0571cde9f95}{engine\-\_\-flush\-\_\-ghosts} (struct \hyperlink{structengine}{engine} $\ast$\hyperlink{potential__eval_8h_ac54d1391e6657558123088943f721021}{e})
\begin{DoxyCompactList}\small\item\em Clear all particles from this \hyperlink{structengine}{engine}'s ghost cells. \end{DoxyCompactList}\item 
int \hyperlink{engine_8c_a6a5018069671d0762806896d927f3a95}{engine\-\_\-setexplepot} (struct \hyperlink{structengine}{engine} $\ast$\hyperlink{potential__eval_8h_ac54d1391e6657558123088943f721021}{e}, struct \hyperlink{structpotential}{potential} $\ast$ep)
\begin{DoxyCompactList}\small\item\em Set the explicit electrostatic potential. \end{DoxyCompactList}\item 
int \hyperlink{engine_8c_a7adfaa512de389a648e45d6a1b315cd9}{engine\-\_\-unload} (struct \hyperlink{structengine}{engine} $\ast$\hyperlink{potential__eval_8h_ac54d1391e6657558123088943f721021}{e}, double $\ast$\hyperlink{potential__eval_8h_a83e62476eec76311df9cccc0496c8e95}{x}, double $\ast$v, int $\ast$type, int $\ast$pid, int $\ast$vid, double $\ast$q, unsigned int $\ast$flags, double $\ast$epot, int N)
\begin{DoxyCompactList}\small\item\em Unload a set of particle data from the \hyperlink{structengine}{engine}. \end{DoxyCompactList}\item 
int \hyperlink{engine_8c_a977a0035dcac10dd069867a10e882c8d}{engine\-\_\-unload\-\_\-marked} (struct \hyperlink{structengine}{engine} $\ast$\hyperlink{potential__eval_8h_ac54d1391e6657558123088943f721021}{e}, double $\ast$\hyperlink{potential__eval_8h_a83e62476eec76311df9cccc0496c8e95}{x}, double $\ast$v, int $\ast$type, int $\ast$pid, int $\ast$vid, double $\ast$q, unsigned int $\ast$flags, double $\ast$epot, int N)
\begin{DoxyCompactList}\small\item\em Unload a set of particle data from the marked cells of an \hyperlink{structengine}{engine}. \end{DoxyCompactList}\item 
int \hyperlink{engine_8c_a699b49b6f65144fdd950812231e4c387}{engine\-\_\-unload\-\_\-strays} (struct \hyperlink{structengine}{engine} $\ast$\hyperlink{potential__eval_8h_ac54d1391e6657558123088943f721021}{e}, double $\ast$\hyperlink{potential__eval_8h_a83e62476eec76311df9cccc0496c8e95}{x}, double $\ast$v, int $\ast$type, int $\ast$pid, int $\ast$vid, double $\ast$q, unsigned int $\ast$flags, double $\ast$epot, int N)
\begin{DoxyCompactList}\small\item\em Unload real particles that may have wandered into a ghost cell. \end{DoxyCompactList}\item 
int \hyperlink{engine_8c_a69d52469a4974f6471fd76c7830e8fd1}{engine\-\_\-load} (struct \hyperlink{structengine}{engine} $\ast$\hyperlink{potential__eval_8h_ac54d1391e6657558123088943f721021}{e}, double $\ast$\hyperlink{potential__eval_8h_a83e62476eec76311df9cccc0496c8e95}{x}, double $\ast$v, int $\ast$type, int $\ast$pid, int $\ast$vid, double $\ast$q, unsigned int $\ast$flags, int N)
\begin{DoxyCompactList}\small\item\em Load a set of particle data. \end{DoxyCompactList}\item 
int \hyperlink{engine_8c_a49b6058437aa43ae800e63ce46f69ea1}{engine\-\_\-load\-\_\-ghosts} (struct \hyperlink{structengine}{engine} $\ast$\hyperlink{potential__eval_8h_ac54d1391e6657558123088943f721021}{e}, double $\ast$\hyperlink{potential__eval_8h_a83e62476eec76311df9cccc0496c8e95}{x}, double $\ast$v, int $\ast$type, int $\ast$pid, int $\ast$vid, double $\ast$q, unsigned int $\ast$flags, int N)
\begin{DoxyCompactList}\small\item\em Load a set of particle data as ghosts. \end{DoxyCompactList}\item 
int \hyperlink{engine_8c_a7f5eb4b18d014939b82c7329f200c64d}{engine\-\_\-gettype} (struct \hyperlink{structengine}{engine} $\ast$\hyperlink{potential__eval_8h_ac54d1391e6657558123088943f721021}{e}, char $\ast$name)
\begin{DoxyCompactList}\small\item\em Look for a given type by name. \end{DoxyCompactList}\item 
int \hyperlink{engine_8c_a5e46198e54b67d4c8a16f1cf9d3c3533}{engine\-\_\-gettype2} (struct \hyperlink{structengine}{engine} $\ast$\hyperlink{potential__eval_8h_ac54d1391e6657558123088943f721021}{e}, char $\ast$name2)
\begin{DoxyCompactList}\small\item\em Look for a given type by its second name. \end{DoxyCompactList}\item 
int \hyperlink{engine_8c_ae5c581d9626ae3f47da431ecd65b223a}{engine\-\_\-addtype} (struct \hyperlink{structengine}{engine} $\ast$\hyperlink{potential__eval_8h_ac54d1391e6657558123088943f721021}{e}, double mass, double charge, char $\ast$name, char $\ast$name2)
\begin{DoxyCompactList}\small\item\em Add a type definition. \end{DoxyCompactList}\item 
int \hyperlink{engine_8c_a0fc5afb224fc0eead89b3ece8e141b29}{engine\-\_\-addpot} (struct \hyperlink{structengine}{engine} $\ast$\hyperlink{potential__eval_8h_ac54d1391e6657558123088943f721021}{e}, struct \hyperlink{structpotential}{potential} $\ast$p, int i, int j)
\begin{DoxyCompactList}\small\item\em Add an interaction potential. \end{DoxyCompactList}\item 
int \hyperlink{engine_8c_a94831a2a9b41da551a85764b2cffe8f7}{engine\-\_\-start} (struct \hyperlink{structengine}{engine} $\ast$\hyperlink{potential__eval_8h_ac54d1391e6657558123088943f721021}{e}, int nr\-\_\-runners, int nr\-\_\-queues)
\begin{DoxyCompactList}\small\item\em Start the runners in the given \hyperlink{structengine}{engine}. \end{DoxyCompactList}\item 
int \hyperlink{engine_8c_acd1955f16ceb52c87d569b923648d52b}{engine\-\_\-start\-\_\-\-S\-P\-U} (struct \hyperlink{structengine}{engine} $\ast$\hyperlink{potential__eval_8h_ac54d1391e6657558123088943f721021}{e}, int nr\-\_\-runners)
\begin{DoxyCompactList}\small\item\em Start the S\-P\-U-\/associated runners in the given \hyperlink{structengine}{engine}. \end{DoxyCompactList}\item 
int \hyperlink{engine_8c_a743f563fdca707aeae7edc1726e13996}{engine\-\_\-nonbond\-\_\-eval} (struct \hyperlink{structengine}{engine} $\ast$\hyperlink{potential__eval_8h_ac54d1391e6657558123088943f721021}{e})
\begin{DoxyCompactList}\small\item\em Compute the nonbonded interactions in the current step. \end{DoxyCompactList}\item 
int \hyperlink{engine_8c_a8660144250e66e9a085023904c9c5285}{engine\-\_\-advance} (struct \hyperlink{structengine}{engine} $\ast$\hyperlink{potential__eval_8h_ac54d1391e6657558123088943f721021}{e})
\begin{DoxyCompactList}\small\item\em Update the particle velocities and positions, re-\/shuffle if appropriate. \end{DoxyCompactList}\item 
int \hyperlink{engine_8c_ab169ee7ceb11536d4907c4a07ae62044}{engine\-\_\-step} (struct \hyperlink{structengine}{engine} $\ast$\hyperlink{potential__eval_8h_ac54d1391e6657558123088943f721021}{e})
\begin{DoxyCompactList}\small\item\em Run the engine for a single time step. \end{DoxyCompactList}\item 
int \hyperlink{engine_8c_aac762f402ed94cd5529bf50c771db96f}{engine\-\_\-barrier} (struct \hyperlink{structengine}{engine} $\ast$\hyperlink{potential__eval_8h_ac54d1391e6657558123088943f721021}{e})
\begin{DoxyCompactList}\small\item\em Barrier routine to hold the {\ttfamily runners} back. \end{DoxyCompactList}\item 
int \hyperlink{engine_8c_a5958b9991d32fbed9413b86b2434a3de}{engine\-\_\-finalize} (struct \hyperlink{structengine}{engine} $\ast$\hyperlink{potential__eval_8h_ac54d1391e6657558123088943f721021}{e})
\begin{DoxyCompactList}\small\item\em Initialize an \hyperlink{structengine}{engine} with the given data and M\-P\-I enabled. \end{DoxyCompactList}\item 
int \hyperlink{engine_8c_a44f518099f47e5692cd6a46022594172}{engine\-\_\-init} (struct \hyperlink{structengine}{engine} $\ast$\hyperlink{potential__eval_8h_ac54d1391e6657558123088943f721021}{e}, const double $\ast$origin, const double $\ast$dim, double $\ast$L, double cutoff, unsigned int period, int max\-\_\-type, unsigned int flags)
\begin{DoxyCompactList}\small\item\em Initialize an \hyperlink{structengine}{engine} with the given data. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{engine_8c_a3724bd1c34d31c4ff37eaff52dc0a580}{engine\-\_\-err} = \hyperlink{engine_8h_ad7d40017c544c2eb7cbf82cbbc9d45e0}{engine\-\_\-err\-\_\-ok}
\item 
char $\ast$ \hyperlink{engine_8c_a389c45b868a2d8c3094c0022ffa482a3}{engine\-\_\-err\-\_\-msg} \mbox{[}29\mbox{]}
\end{DoxyCompactItemize}


\subsection{Macro Definition Documentation}
\hypertarget{engine_8c_a7673862d447029edaf3172ebd94aa28e}{\index{engine.\-c@{engine.\-c}!error@{error}}
\index{error@{error}!engine.c@{engine.\-c}}
\subsubsection[{error}]{\setlength{\rightskip}{0pt plus 5cm}\#define error(
\begin{DoxyParamCaption}
\item[{}]{{\bf id}}
\end{DoxyParamCaption}
)~( {\bf engine\-\_\-err} = {\bf errs\-\_\-register}( {\bf id} , {\bf engine\-\_\-err\-\_\-msg}\mbox{[}-\/({\bf id})\mbox{]} , \-\_\-\-\_\-\-L\-I\-N\-E\-\_\-\-\_\- , \-\_\-\-\_\-\-F\-U\-N\-C\-T\-I\-O\-N\-\_\-\-\_\- , \-\_\-\-\_\-\-F\-I\-L\-E\-\_\-\-\_\- ) )}}\label{engine_8c_a7673862d447029edaf3172ebd94aa28e}


\subsection{Function Documentation}
\hypertarget{engine_8c_a0fc5afb224fc0eead89b3ece8e141b29}{\index{engine.\-c@{engine.\-c}!engine\-\_\-addpot@{engine\-\_\-addpot}}
\index{engine\-\_\-addpot@{engine\-\_\-addpot}!engine.c@{engine.\-c}}
\subsubsection[{engine\-\_\-addpot}]{\setlength{\rightskip}{0pt plus 5cm}int engine\-\_\-addpot (
\begin{DoxyParamCaption}
\item[{struct {\bf engine} $\ast$}]{e, }
\item[{struct {\bf potential} $\ast$}]{p, }
\item[{int}]{i, }
\item[{int}]{j}
\end{DoxyParamCaption}
)}}\label{engine_8c_a0fc5afb224fc0eead89b3ece8e141b29}


Add an interaction potential. 


\begin{DoxyParams}{Parameters}
{\em e} & The \hyperlink{structengine}{engine}. \\
\hline
{\em p} & The \hyperlink{structpotential}{potential} to add to the \hyperlink{structengine}{engine}. \\
\hline
{\em i} & I\-D of particle type for this interaction. \\
\hline
{\em j} & I\-D of second particle type for this interaction.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
\hyperlink{engine_8h_ad7d40017c544c2eb7cbf82cbbc9d45e0}{engine\-\_\-err\-\_\-ok} or $<$ 0 on error (see \hyperlink{engine_8h_a3724bd1c34d31c4ff37eaff52dc0a580}{engine\-\_\-err}).
\end{DoxyReturn}
Adds the given potential for pairs of particles of type {\ttfamily i} and {\ttfamily j}, where {\ttfamily i} and {\ttfamily j} may be the same type I\-D. \hypertarget{engine_8c_ae5c581d9626ae3f47da431ecd65b223a}{\index{engine.\-c@{engine.\-c}!engine\-\_\-addtype@{engine\-\_\-addtype}}
\index{engine\-\_\-addtype@{engine\-\_\-addtype}!engine.c@{engine.\-c}}
\subsubsection[{engine\-\_\-addtype}]{\setlength{\rightskip}{0pt plus 5cm}int engine\-\_\-addtype (
\begin{DoxyParamCaption}
\item[{struct {\bf engine} $\ast$}]{e, }
\item[{double}]{mass, }
\item[{double}]{charge, }
\item[{char $\ast$}]{name, }
\item[{char $\ast$}]{name2}
\end{DoxyParamCaption}
)}}\label{engine_8c_ae5c581d9626ae3f47da431ecd65b223a}


Add a type definition. 


\begin{DoxyParams}{Parameters}
{\em e} & The \hyperlink{structengine}{engine}. \\
\hline
{\em mass} & The particle type mass. \\
\hline
{\em charge} & The particle type charge. \\
\hline
{\em name} & Particle name, can be {\ttfamily N\-U\-L\-L}. \\
\hline
{\em name2} & Particle second name, can be {\ttfamily N\-U\-L\-L}.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The type I\-D or $<$ 0 on error (see \hyperlink{engine_8h_a3724bd1c34d31c4ff37eaff52dc0a580}{engine\-\_\-err}).
\end{DoxyReturn}
The particle type I\-D must be an integer greater or equal to 0 and less than the value {\ttfamily max\-\_\-type} specified in \hyperlink{engine_8h_a44f518099f47e5692cd6a46022594172}{engine\-\_\-init}. \hypertarget{engine_8c_a8660144250e66e9a085023904c9c5285}{\index{engine.\-c@{engine.\-c}!engine\-\_\-advance@{engine\-\_\-advance}}
\index{engine\-\_\-advance@{engine\-\_\-advance}!engine.c@{engine.\-c}}
\subsubsection[{engine\-\_\-advance}]{\setlength{\rightskip}{0pt plus 5cm}int engine\-\_\-advance (
\begin{DoxyParamCaption}
\item[{struct {\bf engine} $\ast$}]{e}
\end{DoxyParamCaption}
)}}\label{engine_8c_a8660144250e66e9a085023904c9c5285}


Update the particle velocities and positions, re-\/shuffle if appropriate. 


\begin{DoxyParams}{Parameters}
{\em e} & The \hyperlink{structengine}{engine} on which to run.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
\hyperlink{engine_8h_ad7d40017c544c2eb7cbf82cbbc9d45e0}{engine\-\_\-err\-\_\-ok} or $<$ 0 on error (see \hyperlink{engine_8h_a3724bd1c34d31c4ff37eaff52dc0a580}{engine\-\_\-err}). 
\end{DoxyReturn}
\hypertarget{engine_8c_aac762f402ed94cd5529bf50c771db96f}{\index{engine.\-c@{engine.\-c}!engine\-\_\-barrier@{engine\-\_\-barrier}}
\index{engine\-\_\-barrier@{engine\-\_\-barrier}!engine.c@{engine.\-c}}
\subsubsection[{engine\-\_\-barrier}]{\setlength{\rightskip}{0pt plus 5cm}int engine\-\_\-barrier (
\begin{DoxyParamCaption}
\item[{struct {\bf engine} $\ast$}]{e}
\end{DoxyParamCaption}
)}}\label{engine_8c_aac762f402ed94cd5529bf50c771db96f}


Barrier routine to hold the {\ttfamily runners} back. 


\begin{DoxyParams}{Parameters}
{\em e} & The \hyperlink{structengine}{engine} to wait on.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
\hyperlink{engine_8h_ad7d40017c544c2eb7cbf82cbbc9d45e0}{engine\-\_\-err\-\_\-ok} or $<$ 0 on error (see \hyperlink{engine_8h_a3724bd1c34d31c4ff37eaff52dc0a580}{engine\-\_\-err}).
\end{DoxyReturn}
After being initialized, and after every timestep, every \hyperlink{structrunner}{runner} calls this routine which blocks until all the runners have returned and the \hyperlink{structengine}{engine} signals the next timestep. \hypertarget{engine_8c_a5958b9991d32fbed9413b86b2434a3de}{\index{engine.\-c@{engine.\-c}!engine\-\_\-finalize@{engine\-\_\-finalize}}
\index{engine\-\_\-finalize@{engine\-\_\-finalize}!engine.c@{engine.\-c}}
\subsubsection[{engine\-\_\-finalize}]{\setlength{\rightskip}{0pt plus 5cm}int engine\-\_\-finalize (
\begin{DoxyParamCaption}
\item[{struct {\bf engine} $\ast$}]{e}
\end{DoxyParamCaption}
)}}\label{engine_8c_a5958b9991d32fbed9413b86b2434a3de}


Initialize an \hyperlink{structengine}{engine} with the given data and M\-P\-I enabled. 


\begin{DoxyParams}{Parameters}
{\em e} & The \hyperlink{structengine}{engine} to initialize. \\
\hline
{\em origin} & An array of three doubles containing the cartesian origin of the space. \\
\hline
{\em dim} & An array of three doubles containing the size of the space. \\
\hline
{\em L} & The minimum cell edge length, should be at least {\ttfamily cutoff}. \\
\hline
{\em cutoff} & The maximum interaction cutoff to use. \\
\hline
{\em period} & A bitmask describing the periodicity of the domain (see \hyperlink{space_8h_af8d717d1aa6319532393f55728c75182}{space\-\_\-periodic\-\_\-full}). \\
\hline
{\em max\-\_\-type} & The maximum number of particle types that will be used by this engine. \\
\hline
{\em flags} & Bit-\/mask containing the flags for this engine. \\
\hline
{\em comm} & The M\-P\-I comm to use. \\
\hline
{\em rank} & The I\-D of this node.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
\hyperlink{engine_8h_ad7d40017c544c2eb7cbf82cbbc9d45e0}{engine\-\_\-err\-\_\-ok} or $<$ 0 on error (see \hyperlink{engine_8h_a3724bd1c34d31c4ff37eaff52dc0a580}{engine\-\_\-err}). Kill all runners and de-\/allocate the data of an engine.
\end{DoxyReturn}

\begin{DoxyParams}{Parameters}
{\em e} & the \hyperlink{structengine}{engine} to finalize.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
\hyperlink{engine_8h_ad7d40017c544c2eb7cbf82cbbc9d45e0}{engine\-\_\-err\-\_\-ok} or $<$ 0 on error (see \hyperlink{engine_8h_a3724bd1c34d31c4ff37eaff52dc0a580}{engine\-\_\-err}). 
\end{DoxyReturn}
\hypertarget{engine_8c_aec725cc5cea5de5ab0cfd4649acee54b}{\index{engine.\-c@{engine.\-c}!engine\-\_\-flush@{engine\-\_\-flush}}
\index{engine\-\_\-flush@{engine\-\_\-flush}!engine.c@{engine.\-c}}
\subsubsection[{engine\-\_\-flush}]{\setlength{\rightskip}{0pt plus 5cm}int engine\-\_\-flush (
\begin{DoxyParamCaption}
\item[{struct {\bf engine} $\ast$}]{e}
\end{DoxyParamCaption}
)}}\label{engine_8c_aec725cc5cea5de5ab0cfd4649acee54b}


Clear all particles from this \hyperlink{structengine}{engine}. 


\begin{DoxyParams}{Parameters}
{\em e} & The \hyperlink{structengine}{engine} to flush.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
\hyperlink{engine_8h_ad7d40017c544c2eb7cbf82cbbc9d45e0}{engine\-\_\-err\-\_\-ok} or $<$ 0 on error (see \hyperlink{engine_8h_a3724bd1c34d31c4ff37eaff52dc0a580}{engine\-\_\-err}). 
\end{DoxyReturn}
\hypertarget{engine_8c_a55d13cd5411d205e44e0b0571cde9f95}{\index{engine.\-c@{engine.\-c}!engine\-\_\-flush\-\_\-ghosts@{engine\-\_\-flush\-\_\-ghosts}}
\index{engine\-\_\-flush\-\_\-ghosts@{engine\-\_\-flush\-\_\-ghosts}!engine.c@{engine.\-c}}
\subsubsection[{engine\-\_\-flush\-\_\-ghosts}]{\setlength{\rightskip}{0pt plus 5cm}int engine\-\_\-flush\-\_\-ghosts (
\begin{DoxyParamCaption}
\item[{struct {\bf engine} $\ast$}]{e}
\end{DoxyParamCaption}
)}}\label{engine_8c_a55d13cd5411d205e44e0b0571cde9f95}


Clear all particles from this \hyperlink{structengine}{engine}'s ghost cells. 


\begin{DoxyParams}{Parameters}
{\em e} & The \hyperlink{structengine}{engine} to flush.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
\hyperlink{engine_8h_ad7d40017c544c2eb7cbf82cbbc9d45e0}{engine\-\_\-err\-\_\-ok} or $<$ 0 on error (see \hyperlink{engine_8h_a3724bd1c34d31c4ff37eaff52dc0a580}{engine\-\_\-err}). 
\end{DoxyReturn}
\hypertarget{engine_8c_a7f5eb4b18d014939b82c7329f200c64d}{\index{engine.\-c@{engine.\-c}!engine\-\_\-gettype@{engine\-\_\-gettype}}
\index{engine\-\_\-gettype@{engine\-\_\-gettype}!engine.c@{engine.\-c}}
\subsubsection[{engine\-\_\-gettype}]{\setlength{\rightskip}{0pt plus 5cm}int engine\-\_\-gettype (
\begin{DoxyParamCaption}
\item[{struct {\bf engine} $\ast$}]{e, }
\item[{char $\ast$}]{name}
\end{DoxyParamCaption}
)}}\label{engine_8c_a7f5eb4b18d014939b82c7329f200c64d}


Look for a given type by name. 


\begin{DoxyParams}{Parameters}
{\em e} & The \hyperlink{structengine}{engine}. \\
\hline
{\em name} & The type name.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The type I\-D or $<$ 0 on error (see \hyperlink{engine_8h_a3724bd1c34d31c4ff37eaff52dc0a580}{engine\-\_\-err}). 
\end{DoxyReturn}
\hypertarget{engine_8c_a5e46198e54b67d4c8a16f1cf9d3c3533}{\index{engine.\-c@{engine.\-c}!engine\-\_\-gettype2@{engine\-\_\-gettype2}}
\index{engine\-\_\-gettype2@{engine\-\_\-gettype2}!engine.c@{engine.\-c}}
\subsubsection[{engine\-\_\-gettype2}]{\setlength{\rightskip}{0pt plus 5cm}int engine\-\_\-gettype2 (
\begin{DoxyParamCaption}
\item[{struct {\bf engine} $\ast$}]{e, }
\item[{char $\ast$}]{name2}
\end{DoxyParamCaption}
)}}\label{engine_8c_a5e46198e54b67d4c8a16f1cf9d3c3533}


Look for a given type by its second name. 


\begin{DoxyParams}{Parameters}
{\em e} & The \hyperlink{structengine}{engine}. \\
\hline
{\em name2} & The type name2.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The type I\-D or $<$ 0 on error (see \hyperlink{engine_8h_a3724bd1c34d31c4ff37eaff52dc0a580}{engine\-\_\-err}). 
\end{DoxyReturn}
\hypertarget{engine_8c_a44f518099f47e5692cd6a46022594172}{\index{engine.\-c@{engine.\-c}!engine\-\_\-init@{engine\-\_\-init}}
\index{engine\-\_\-init@{engine\-\_\-init}!engine.c@{engine.\-c}}
\subsubsection[{engine\-\_\-init}]{\setlength{\rightskip}{0pt plus 5cm}int engine\-\_\-init (
\begin{DoxyParamCaption}
\item[{struct {\bf engine} $\ast$}]{e, }
\item[{const double $\ast$}]{origin, }
\item[{const double $\ast$}]{dim, }
\item[{double $\ast$}]{L, }
\item[{double}]{cutoff, }
\item[{unsigned int}]{period, }
\item[{int}]{max\-\_\-type, }
\item[{unsigned int}]{flags}
\end{DoxyParamCaption}
)}}\label{engine_8c_a44f518099f47e5692cd6a46022594172}


Initialize an \hyperlink{structengine}{engine} with the given data. 


\begin{DoxyParams}{Parameters}
{\em e} & The \hyperlink{structengine}{engine} to initialize. \\
\hline
{\em origin} & An array of three doubles containing the cartesian origin of the space. \\
\hline
{\em dim} & An array of three doubles containing the size of the space. \\
\hline
{\em L} & The minimum cell edge length in each dimension. \\
\hline
{\em cutoff} & The maximum interaction cutoff to use. \\
\hline
{\em period} & A bitmask describing the periodicity of the domain (see \hyperlink{space_8h_af8d717d1aa6319532393f55728c75182}{space\-\_\-periodic\-\_\-full}). \\
\hline
{\em max\-\_\-type} & The maximum number of particle types that will be used by this engine. \\
\hline
{\em flags} & Bit-\/mask containing the flags for this engine.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
\hyperlink{engine_8h_ad7d40017c544c2eb7cbf82cbbc9d45e0}{engine\-\_\-err\-\_\-ok} or $<$ 0 on error (see \hyperlink{engine_8h_a3724bd1c34d31c4ff37eaff52dc0a580}{engine\-\_\-err}). 
\end{DoxyReturn}
\hypertarget{engine_8c_a69d52469a4974f6471fd76c7830e8fd1}{\index{engine.\-c@{engine.\-c}!engine\-\_\-load@{engine\-\_\-load}}
\index{engine\-\_\-load@{engine\-\_\-load}!engine.c@{engine.\-c}}
\subsubsection[{engine\-\_\-load}]{\setlength{\rightskip}{0pt plus 5cm}int engine\-\_\-load (
\begin{DoxyParamCaption}
\item[{struct {\bf engine} $\ast$}]{e, }
\item[{double $\ast$}]{x, }
\item[{double $\ast$}]{v, }
\item[{int $\ast$}]{type, }
\item[{int $\ast$}]{pid, }
\item[{int $\ast$}]{vid, }
\item[{double $\ast$}]{q, }
\item[{unsigned int $\ast$}]{flags, }
\item[{int}]{N}
\end{DoxyParamCaption}
)}}\label{engine_8c_a69d52469a4974f6471fd76c7830e8fd1}


Load a set of particle data. 


\begin{DoxyParams}{Parameters}
{\em e} & The \hyperlink{structengine}{engine}. \\
\hline
{\em x} & An {\ttfamily N} times 3 array of the particle positions. \\
\hline
{\em v} & An {\ttfamily N} times 3 array of the particle velocities. \\
\hline
{\em type} & A vector of length {\ttfamily N} of the particle type I\-Ds. \\
\hline
{\em pid} & A vector of length {\ttfamily N} of the particle I\-Ds. \\
\hline
{\em vid} & A vector of length {\ttfamily N} of the particle virtual I\-Ds. \\
\hline
{\em q} & A vector of length {\ttfamily N} of the individual particle charges. \\
\hline
{\em flags} & A vector of length {\ttfamily N} of the particle flags. \\
\hline
{\em N} & the number of particles to load.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
\hyperlink{engine_8h_ad7d40017c544c2eb7cbf82cbbc9d45e0}{engine\-\_\-err\-\_\-ok} or $<$ 0 on error (see \hyperlink{engine_8h_a3724bd1c34d31c4ff37eaff52dc0a580}{engine\-\_\-err}).
\end{DoxyReturn}
If the parameters {\ttfamily v}, {\ttfamily flags}, {\ttfamily vid} or {\ttfamily q} are {\ttfamily N\-U\-L\-L}, then these values are set to zero. \hypertarget{engine_8c_a49b6058437aa43ae800e63ce46f69ea1}{\index{engine.\-c@{engine.\-c}!engine\-\_\-load\-\_\-ghosts@{engine\-\_\-load\-\_\-ghosts}}
\index{engine\-\_\-load\-\_\-ghosts@{engine\-\_\-load\-\_\-ghosts}!engine.c@{engine.\-c}}
\subsubsection[{engine\-\_\-load\-\_\-ghosts}]{\setlength{\rightskip}{0pt plus 5cm}int engine\-\_\-load\-\_\-ghosts (
\begin{DoxyParamCaption}
\item[{struct {\bf engine} $\ast$}]{e, }
\item[{double $\ast$}]{x, }
\item[{double $\ast$}]{v, }
\item[{int $\ast$}]{type, }
\item[{int $\ast$}]{pid, }
\item[{int $\ast$}]{vid, }
\item[{double $\ast$}]{q, }
\item[{unsigned int $\ast$}]{flags, }
\item[{int}]{N}
\end{DoxyParamCaption}
)}}\label{engine_8c_a49b6058437aa43ae800e63ce46f69ea1}


Load a set of particle data as ghosts. 


\begin{DoxyParams}{Parameters}
{\em e} & The \hyperlink{structengine}{engine}. \\
\hline
{\em x} & An {\ttfamily N} times 3 array of the particle positions. \\
\hline
{\em v} & An {\ttfamily N} times 3 array of the particle velocities. \\
\hline
{\em type} & A vector of length {\ttfamily N} of the particle type I\-Ds. \\
\hline
{\em pid} & A vector of length {\ttfamily N} of the particle I\-Ds. \\
\hline
{\em vid} & A vector of length {\ttfamily N} of the particle virtual I\-Ds. \\
\hline
{\em q} & A vector of length {\ttfamily N} of the individual particle charges. \\
\hline
{\em flags} & A vector of length {\ttfamily N} of the particle flags. \\
\hline
{\em N} & the number of particles to load.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
\hyperlink{engine_8h_ad7d40017c544c2eb7cbf82cbbc9d45e0}{engine\-\_\-err\-\_\-ok} or $<$ 0 on error (see \hyperlink{engine_8h_a3724bd1c34d31c4ff37eaff52dc0a580}{engine\-\_\-err}).
\end{DoxyReturn}
If the parameters {\ttfamily v}, {\ttfamily flags}, {\ttfamily vid} or {\ttfamily q} are {\ttfamily N\-U\-L\-L}, then these values are set to zero. \hypertarget{engine_8c_a743f563fdca707aeae7edc1726e13996}{\index{engine.\-c@{engine.\-c}!engine\-\_\-nonbond\-\_\-eval@{engine\-\_\-nonbond\-\_\-eval}}
\index{engine\-\_\-nonbond\-\_\-eval@{engine\-\_\-nonbond\-\_\-eval}!engine.c@{engine.\-c}}
\subsubsection[{engine\-\_\-nonbond\-\_\-eval}]{\setlength{\rightskip}{0pt plus 5cm}int engine\-\_\-nonbond\-\_\-eval (
\begin{DoxyParamCaption}
\item[{struct {\bf engine} $\ast$}]{e}
\end{DoxyParamCaption}
)}}\label{engine_8c_a743f563fdca707aeae7edc1726e13996}


Compute the nonbonded interactions in the current step. 


\begin{DoxyParams}{Parameters}
{\em e} & The \hyperlink{structengine}{engine} on which to run.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
\hyperlink{engine_8h_ad7d40017c544c2eb7cbf82cbbc9d45e0}{engine\-\_\-err\-\_\-ok} or $<$ 0 on error (see \hyperlink{engine_8h_a3724bd1c34d31c4ff37eaff52dc0a580}{engine\-\_\-err}).
\end{DoxyReturn}
This routine advances the timestep counter by one, prepares the \hyperlink{structspace}{space} for a timestep, releases the \hyperlink{structrunner}{runner}'s associated with the \hyperlink{structengine}{engine} and waits for them to finnish. \hypertarget{engine_8c_a6a5018069671d0762806896d927f3a95}{\index{engine.\-c@{engine.\-c}!engine\-\_\-setexplepot@{engine\-\_\-setexplepot}}
\index{engine\-\_\-setexplepot@{engine\-\_\-setexplepot}!engine.c@{engine.\-c}}
\subsubsection[{engine\-\_\-setexplepot}]{\setlength{\rightskip}{0pt plus 5cm}int engine\-\_\-setexplepot (
\begin{DoxyParamCaption}
\item[{struct {\bf engine} $\ast$}]{e, }
\item[{struct {\bf potential} $\ast$}]{ep}
\end{DoxyParamCaption}
)}}\label{engine_8c_a6a5018069671d0762806896d927f3a95}


Set the explicit electrostatic potential. 


\begin{DoxyParams}{Parameters}
{\em e} & The \hyperlink{structengine}{engine}. \\
\hline
{\em ep} & The electrostatic \hyperlink{structpotential}{potential}.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
\hyperlink{engine_8h_ad7d40017c544c2eb7cbf82cbbc9d45e0}{engine\-\_\-err\-\_\-ok} or $<$ 0 on error (see \hyperlink{engine_8h_a3724bd1c34d31c4ff37eaff52dc0a580}{engine\-\_\-err}).
\end{DoxyReturn}
If {\ttfamily ep} is not {\ttfamily N\-U\-L\-L}, the flag \hyperlink{engine_8h_ad551f1485c9d3adda913dfbe2f5a5b58}{engine\-\_\-flag\-\_\-explepot} is set, otherwise it is cleared. \hypertarget{engine_8c_aee24cd486d7bc6be737df5ecd43cd68b}{\index{engine.\-c@{engine.\-c}!engine\-\_\-shuffle@{engine\-\_\-shuffle}}
\index{engine\-\_\-shuffle@{engine\-\_\-shuffle}!engine.c@{engine.\-c}}
\subsubsection[{engine\-\_\-shuffle}]{\setlength{\rightskip}{0pt plus 5cm}int engine\-\_\-shuffle (
\begin{DoxyParamCaption}
\item[{struct {\bf engine} $\ast$}]{e}
\end{DoxyParamCaption}
)}}\label{engine_8c_aee24cd486d7bc6be737df5ecd43cd68b}


Re-\/shuffle the particles in the engine. 


\begin{DoxyParams}{Parameters}
{\em e} & The \hyperlink{structengine}{engine} on which to run.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
\hyperlink{engine_8h_ad7d40017c544c2eb7cbf82cbbc9d45e0}{engine\-\_\-err\-\_\-ok} or $<$ 0 on error (see \hyperlink{engine_8h_a3724bd1c34d31c4ff37eaff52dc0a580}{engine\-\_\-err}). 
\end{DoxyReturn}
\hypertarget{engine_8c_a58eed0f9b4140be350b08e1742627f87}{\index{engine.\-c@{engine.\-c}!engine\-\_\-split@{engine\-\_\-split}}
\index{engine\-\_\-split@{engine\-\_\-split}!engine.c@{engine.\-c}}
\subsubsection[{engine\-\_\-split}]{\setlength{\rightskip}{0pt plus 5cm}int engine\-\_\-split (
\begin{DoxyParamCaption}
\item[{struct {\bf engine} $\ast$}]{e}
\end{DoxyParamCaption}
)}}\label{engine_8c_a58eed0f9b4140be350b08e1742627f87}


Set-\/up the engine for distributed-\/memory parallel operation. 


\begin{DoxyParams}{Parameters}
{\em e} & The \hyperlink{structengine}{engine} to set-\/up.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
\hyperlink{engine_8h_ad7d40017c544c2eb7cbf82cbbc9d45e0}{engine\-\_\-err\-\_\-ok} or $<$ 0 on error (see \hyperlink{engine_8h_a3724bd1c34d31c4ff37eaff52dc0a580}{engine\-\_\-err}).
\end{DoxyReturn}
This function assumes that \hyperlink{engine_8h_ad8e0c8513f4fbf6fc18f3166b4484044}{engine\-\_\-split\-\_\-bisect} or some similar function has already been called and that \#node\-I\-D, \#nr\-\_\-nodes as well as the \hyperlink{structcell}{cell} {\ttfamily node\-I\-Ds} have been set. \hypertarget{engine_8c_ad8e0c8513f4fbf6fc18f3166b4484044}{\index{engine.\-c@{engine.\-c}!engine\-\_\-split\-\_\-bisect@{engine\-\_\-split\-\_\-bisect}}
\index{engine\-\_\-split\-\_\-bisect@{engine\-\_\-split\-\_\-bisect}!engine.c@{engine.\-c}}
\subsubsection[{engine\-\_\-split\-\_\-bisect}]{\setlength{\rightskip}{0pt plus 5cm}int engine\-\_\-split\-\_\-bisect (
\begin{DoxyParamCaption}
\item[{struct {\bf engine} $\ast$}]{e, }
\item[{int}]{N}
\end{DoxyParamCaption}
)}}\label{engine_8c_ad8e0c8513f4fbf6fc18f3166b4484044}


Split the computational domain over a number of nodes using bisection. 


\begin{DoxyParams}{Parameters}
{\em e} & The \hyperlink{structengine}{engine} to split up. \\
\hline
{\em N} & The number of computational nodes.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
\hyperlink{engine_8h_ad7d40017c544c2eb7cbf82cbbc9d45e0}{engine\-\_\-err\-\_\-ok} or $<$ 0 on error (see \hyperlink{engine_8h_a3724bd1c34d31c4ff37eaff52dc0a580}{engine\-\_\-err}). 
\end{DoxyReturn}
\hypertarget{engine_8c_af88982963377c8df684162bda505fe9d}{\index{engine.\-c@{engine.\-c}!engine\-\_\-split\-\_\-\-M\-E\-T\-I\-S@{engine\-\_\-split\-\_\-\-M\-E\-T\-I\-S}}
\index{engine\-\_\-split\-\_\-\-M\-E\-T\-I\-S@{engine\-\_\-split\-\_\-\-M\-E\-T\-I\-S}!engine.c@{engine.\-c}}
\subsubsection[{engine\-\_\-split\-\_\-\-M\-E\-T\-I\-S}]{\setlength{\rightskip}{0pt plus 5cm}int engine\-\_\-split\-\_\-\-M\-E\-T\-I\-S (
\begin{DoxyParamCaption}
\item[{struct {\bf engine} $\ast$}]{e, }
\item[{int}]{N, }
\item[{int}]{flags}
\end{DoxyParamCaption}
)}}\label{engine_8c_af88982963377c8df684162bda505fe9d}


Split the computation domain over a number of nodes using M\-E\-T\-I\-S graph partitioning. 


\begin{DoxyParams}{Parameters}
{\em e} & The \hyperlink{structengine}{engine} to split up. \\
\hline
{\em N} & The number of computational nodes. \\
\hline
{\em flags} & Flag telling whether to split the space for M\-P\-I or for G\-P\-Us.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
\hyperlink{engine_8h_ad7d40017c544c2eb7cbf82cbbc9d45e0}{engine\-\_\-err\-\_\-ok} or $<$ 0 on error (see \hyperlink{engine_8h_a3724bd1c34d31c4ff37eaff52dc0a580}{engine\-\_\-err}). 
\end{DoxyReturn}
\hypertarget{engine_8c_a94831a2a9b41da551a85764b2cffe8f7}{\index{engine.\-c@{engine.\-c}!engine\-\_\-start@{engine\-\_\-start}}
\index{engine\-\_\-start@{engine\-\_\-start}!engine.c@{engine.\-c}}
\subsubsection[{engine\-\_\-start}]{\setlength{\rightskip}{0pt plus 5cm}int engine\-\_\-start (
\begin{DoxyParamCaption}
\item[{struct {\bf engine} $\ast$}]{e, }
\item[{int}]{nr\-\_\-runners, }
\item[{int}]{nr\-\_\-queues}
\end{DoxyParamCaption}
)}}\label{engine_8c_a94831a2a9b41da551a85764b2cffe8f7}


Start the runners in the given \hyperlink{structengine}{engine}. 


\begin{DoxyParams}{Parameters}
{\em e} & The \hyperlink{structengine}{engine} to start. \\
\hline
{\em nr\-\_\-runners} & The number of runners start.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
\hyperlink{engine_8h_ad7d40017c544c2eb7cbf82cbbc9d45e0}{engine\-\_\-err\-\_\-ok} or $<$ 0 on error (see \hyperlink{engine_8h_a3724bd1c34d31c4ff37eaff52dc0a580}{engine\-\_\-err}).
\end{DoxyReturn}
Allocates and starts the specified number of \hyperlink{structrunner}{runner}. Also initializes the Verlet lists. \hypertarget{engine_8c_acd1955f16ceb52c87d569b923648d52b}{\index{engine.\-c@{engine.\-c}!engine\-\_\-start\-\_\-\-S\-P\-U@{engine\-\_\-start\-\_\-\-S\-P\-U}}
\index{engine\-\_\-start\-\_\-\-S\-P\-U@{engine\-\_\-start\-\_\-\-S\-P\-U}!engine.c@{engine.\-c}}
\subsubsection[{engine\-\_\-start\-\_\-\-S\-P\-U}]{\setlength{\rightskip}{0pt plus 5cm}int engine\-\_\-start\-\_\-\-S\-P\-U (
\begin{DoxyParamCaption}
\item[{struct {\bf engine} $\ast$}]{e, }
\item[{int}]{nr\-\_\-runners}
\end{DoxyParamCaption}
)}}\label{engine_8c_acd1955f16ceb52c87d569b923648d52b}


Start the S\-P\-U-\/associated runners in the given \hyperlink{structengine}{engine}. 


\begin{DoxyParams}{Parameters}
{\em e} & The \hyperlink{structengine}{engine} to start. \\
\hline
{\em nr\-\_\-runners} & The number of runners start.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
\hyperlink{engine_8h_ad7d40017c544c2eb7cbf82cbbc9d45e0}{engine\-\_\-err\-\_\-ok} or $<$ 0 on error (see \hyperlink{engine_8h_a3724bd1c34d31c4ff37eaff52dc0a580}{engine\-\_\-err}).
\end{DoxyReturn}
Allocates and starts the specified number of \hyperlink{structrunner}{runner}. \hypertarget{engine_8c_ab169ee7ceb11536d4907c4a07ae62044}{\index{engine.\-c@{engine.\-c}!engine\-\_\-step@{engine\-\_\-step}}
\index{engine\-\_\-step@{engine\-\_\-step}!engine.c@{engine.\-c}}
\subsubsection[{engine\-\_\-step}]{\setlength{\rightskip}{0pt plus 5cm}int engine\-\_\-step (
\begin{DoxyParamCaption}
\item[{struct {\bf engine} $\ast$}]{e}
\end{DoxyParamCaption}
)}}\label{engine_8c_ab169ee7ceb11536d4907c4a07ae62044}


Run the engine for a single time step. 


\begin{DoxyParams}{Parameters}
{\em e} & The \hyperlink{structengine}{engine} on which to run.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
\hyperlink{engine_8h_ad7d40017c544c2eb7cbf82cbbc9d45e0}{engine\-\_\-err\-\_\-ok} or $<$ 0 on error (see \hyperlink{engine_8h_a3724bd1c34d31c4ff37eaff52dc0a580}{engine\-\_\-err}).
\end{DoxyReturn}
This routine advances the timestep counter by one, prepares the \hyperlink{structspace}{space} for a timestep, releases the \hyperlink{structrunner}{runner}'s associated with the \hyperlink{structengine}{engine} and waits for them to finnish.

Once all the \hyperlink{structrunner}{runner}'s are done, the particle velocities and positions are updated and the particles are re-\/sorted in the \hyperlink{structspace}{space}. \hypertarget{engine_8c_ad67df51519859e9386275e0cc084f840}{\index{engine.\-c@{engine.\-c}!engine\-\_\-timers\-\_\-reset@{engine\-\_\-timers\-\_\-reset}}
\index{engine\-\_\-timers\-\_\-reset@{engine\-\_\-timers\-\_\-reset}!engine.c@{engine.\-c}}
\subsubsection[{engine\-\_\-timers\-\_\-reset}]{\setlength{\rightskip}{0pt plus 5cm}int engine\-\_\-timers\-\_\-reset (
\begin{DoxyParamCaption}
\item[{struct {\bf engine} $\ast$}]{e}
\end{DoxyParamCaption}
)}}\label{engine_8c_ad67df51519859e9386275e0cc084f840}


Set all the engine timers to 0. 


\begin{DoxyParams}{Parameters}
{\em e} & The \hyperlink{structengine}{engine}.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
\hyperlink{engine_8h_ad7d40017c544c2eb7cbf82cbbc9d45e0}{engine\-\_\-err\-\_\-ok} or $<$ 0 on error (see \hyperlink{engine_8h_a3724bd1c34d31c4ff37eaff52dc0a580}{engine\-\_\-err}). 
\end{DoxyReturn}
\hypertarget{engine_8c_a7adfaa512de389a648e45d6a1b315cd9}{\index{engine.\-c@{engine.\-c}!engine\-\_\-unload@{engine\-\_\-unload}}
\index{engine\-\_\-unload@{engine\-\_\-unload}!engine.c@{engine.\-c}}
\subsubsection[{engine\-\_\-unload}]{\setlength{\rightskip}{0pt plus 5cm}int engine\-\_\-unload (
\begin{DoxyParamCaption}
\item[{struct {\bf engine} $\ast$}]{e, }
\item[{double $\ast$}]{x, }
\item[{double $\ast$}]{v, }
\item[{int $\ast$}]{type, }
\item[{int $\ast$}]{pid, }
\item[{int $\ast$}]{vid, }
\item[{double $\ast$}]{q, }
\item[{unsigned int $\ast$}]{flags, }
\item[{double $\ast$}]{epot, }
\item[{int}]{N}
\end{DoxyParamCaption}
)}}\label{engine_8c_a7adfaa512de389a648e45d6a1b315cd9}


Unload a set of particle data from the \hyperlink{structengine}{engine}. 


\begin{DoxyParams}{Parameters}
{\em e} & The \hyperlink{structengine}{engine}. \\
\hline
{\em x} & An {\ttfamily N} times 3 array of the particle positions. \\
\hline
{\em v} & An {\ttfamily N} times 3 array of the particle velocities. \\
\hline
{\em type} & A vector of length {\ttfamily N} of the particle type I\-Ds. \\
\hline
{\em pid} & A vector of length {\ttfamily N} of the particle I\-Ds. \\
\hline
{\em vid} & A vector of length {\ttfamily N} of the particle virtual I\-Ds. \\
\hline
{\em q} & A vector of length {\ttfamily N} of the individual particle charges. \\
\hline
{\em flags} & A vector of length {\ttfamily N} of the particle flags. \\
\hline
{\em epot} & A pointer to a \#double in which to store the total potential energy. \\
\hline
{\em N} & the maximum number of particles.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The number of particles unloaded or $<$ 0 on error (see \hyperlink{engine_8h_a3724bd1c34d31c4ff37eaff52dc0a580}{engine\-\_\-err}).
\end{DoxyReturn}
The fields {\ttfamily x}, {\ttfamily v}, {\ttfamily type}, {\ttfamily pid}, {\ttfamily vid}, {\ttfamily q}, {\ttfamily epot} and/or {\ttfamily flags} may be N\-U\-L\-L. \hypertarget{engine_8c_a977a0035dcac10dd069867a10e882c8d}{\index{engine.\-c@{engine.\-c}!engine\-\_\-unload\-\_\-marked@{engine\-\_\-unload\-\_\-marked}}
\index{engine\-\_\-unload\-\_\-marked@{engine\-\_\-unload\-\_\-marked}!engine.c@{engine.\-c}}
\subsubsection[{engine\-\_\-unload\-\_\-marked}]{\setlength{\rightskip}{0pt plus 5cm}int engine\-\_\-unload\-\_\-marked (
\begin{DoxyParamCaption}
\item[{struct {\bf engine} $\ast$}]{e, }
\item[{double $\ast$}]{x, }
\item[{double $\ast$}]{v, }
\item[{int $\ast$}]{type, }
\item[{int $\ast$}]{pid, }
\item[{int $\ast$}]{vid, }
\item[{double $\ast$}]{q, }
\item[{unsigned int $\ast$}]{flags, }
\item[{double $\ast$}]{epot, }
\item[{int}]{N}
\end{DoxyParamCaption}
)}}\label{engine_8c_a977a0035dcac10dd069867a10e882c8d}


Unload a set of particle data from the marked cells of an \hyperlink{structengine}{engine}. 


\begin{DoxyParams}{Parameters}
{\em e} & The \hyperlink{structengine}{engine}. \\
\hline
{\em x} & An {\ttfamily N} times 3 array of the particle positions. \\
\hline
{\em v} & An {\ttfamily N} times 3 array of the particle velocities. \\
\hline
{\em type} & A vector of length {\ttfamily N} of the particle type I\-Ds. \\
\hline
{\em pid} & A vector of length {\ttfamily N} of the particle I\-Ds. \\
\hline
{\em vid} & A vector of length {\ttfamily N} of the particle virtual I\-Ds. \\
\hline
{\em q} & A vector of length {\ttfamily N} of the individual particle charges. \\
\hline
{\em flags} & A vector of length {\ttfamily N} of the particle flags. \\
\hline
{\em epot} & A pointer to a \#double in which to store the total potential energy. \\
\hline
{\em N} & the maximum number of particles.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The number of particles unloaded or $<$ 0 on error (see \hyperlink{engine_8h_a3724bd1c34d31c4ff37eaff52dc0a580}{engine\-\_\-err}).
\end{DoxyReturn}
The fields {\ttfamily x}, {\ttfamily v}, {\ttfamily type}, {\ttfamily pid}, {\ttfamily vid}, {\ttfamily q}, {\ttfamily epot} and/or {\ttfamily flags} may be N\-U\-L\-L. \hypertarget{engine_8c_a699b49b6f65144fdd950812231e4c387}{\index{engine.\-c@{engine.\-c}!engine\-\_\-unload\-\_\-strays@{engine\-\_\-unload\-\_\-strays}}
\index{engine\-\_\-unload\-\_\-strays@{engine\-\_\-unload\-\_\-strays}!engine.c@{engine.\-c}}
\subsubsection[{engine\-\_\-unload\-\_\-strays}]{\setlength{\rightskip}{0pt plus 5cm}int engine\-\_\-unload\-\_\-strays (
\begin{DoxyParamCaption}
\item[{struct {\bf engine} $\ast$}]{e, }
\item[{double $\ast$}]{x, }
\item[{double $\ast$}]{v, }
\item[{int $\ast$}]{type, }
\item[{int $\ast$}]{pid, }
\item[{int $\ast$}]{vid, }
\item[{double $\ast$}]{q, }
\item[{unsigned int $\ast$}]{flags, }
\item[{double $\ast$}]{epot, }
\item[{int}]{N}
\end{DoxyParamCaption}
)}}\label{engine_8c_a699b49b6f65144fdd950812231e4c387}


Unload real particles that may have wandered into a ghost cell. 


\begin{DoxyParams}{Parameters}
{\em e} & The \hyperlink{structengine}{engine}. \\
\hline
{\em x} & An {\ttfamily N} times 3 array of the particle positions. \\
\hline
{\em v} & An {\ttfamily N} times 3 array of the particle velocities. \\
\hline
{\em type} & A vector of length {\ttfamily N} of the particle type I\-Ds. \\
\hline
{\em pid} & A vector of length {\ttfamily N} of the particle I\-Ds. \\
\hline
{\em vid} & A vector of length {\ttfamily N} of the particle virtual I\-Ds. \\
\hline
{\em q} & A vector of length {\ttfamily N} of the individual particle charges. \\
\hline
{\em flags} & A vector of length {\ttfamily N} of the particle flags. \\
\hline
{\em epot} & A pointer to a \#double in which to store the total potential energy. \\
\hline
{\em N} & the maximum number of particles.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The number of particles unloaded or $<$ 0 on error (see \hyperlink{engine_8h_a3724bd1c34d31c4ff37eaff52dc0a580}{engine\-\_\-err}).
\end{DoxyReturn}
The fields {\ttfamily x}, {\ttfamily v}, {\ttfamily type}, {\ttfamily vid}, {\ttfamily pid}, {\ttfamily q}, {\ttfamily epot} and/or {\ttfamily flags} may be N\-U\-L\-L. \hypertarget{engine_8c_a83702eb8b53c1de5addc229530571f1e}{\index{engine.\-c@{engine.\-c}!engine\-\_\-verlet\-\_\-update@{engine\-\_\-verlet\-\_\-update}}
\index{engine\-\_\-verlet\-\_\-update@{engine\-\_\-verlet\-\_\-update}!engine.c@{engine.\-c}}
\subsubsection[{engine\-\_\-verlet\-\_\-update}]{\setlength{\rightskip}{0pt plus 5cm}int engine\-\_\-verlet\-\_\-update (
\begin{DoxyParamCaption}
\item[{struct {\bf engine} $\ast$}]{e}
\end{DoxyParamCaption}
)}}\label{engine_8c_a83702eb8b53c1de5addc229530571f1e}


Check if the Verlet-\/list needs to be updated. 


\begin{DoxyParams}{Parameters}
{\em e} & The \hyperlink{structengine}{engine}.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
\hyperlink{engine_8h_ad7d40017c544c2eb7cbf82cbbc9d45e0}{engine\-\_\-err\-\_\-ok} or $<$ 0 on error (see \hyperlink{engine_8h_a3724bd1c34d31c4ff37eaff52dc0a580}{engine\-\_\-err}). 
\end{DoxyReturn}


\subsection{Variable Documentation}
\hypertarget{engine_8c_a3724bd1c34d31c4ff37eaff52dc0a580}{\index{engine.\-c@{engine.\-c}!engine\-\_\-err@{engine\-\_\-err}}
\index{engine\-\_\-err@{engine\-\_\-err}!engine.c@{engine.\-c}}
\subsubsection[{engine\-\_\-err}]{\setlength{\rightskip}{0pt plus 5cm}int engine\-\_\-err = {\bf engine\-\_\-err\-\_\-ok}}}\label{engine_8c_a3724bd1c34d31c4ff37eaff52dc0a580}
I\-D of the last error. \hypertarget{engine_8c_a389c45b868a2d8c3094c0022ffa482a3}{\index{engine.\-c@{engine.\-c}!engine\-\_\-err\-\_\-msg@{engine\-\_\-err\-\_\-msg}}
\index{engine\-\_\-err\-\_\-msg@{engine\-\_\-err\-\_\-msg}!engine.c@{engine.\-c}}
\subsubsection[{engine\-\_\-err\-\_\-msg}]{\setlength{\rightskip}{0pt plus 5cm}char$\ast$ engine\-\_\-err\-\_\-msg\mbox{[}29\mbox{]}}}\label{engine_8c_a389c45b868a2d8c3094c0022ffa482a3}
List of error messages. 