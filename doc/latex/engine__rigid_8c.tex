\hypertarget{engine__rigid_8c}{\section{/home/stephan/code/unversioned/mdcore-\/0.1.7/src/engine\-\_\-rigid.c File Reference}
\label{engine__rigid_8c}\index{/home/stephan/code/unversioned/mdcore-\/0.\-1.\-7/src/engine\-\_\-rigid.\-c@{/home/stephan/code/unversioned/mdcore-\/0.\-1.\-7/src/engine\-\_\-rigid.\-c}}
}
{\ttfamily \#include $<$stdlib.\-h$>$}\\*
{\ttfamily \#include $<$stdio.\-h$>$}\\*
{\ttfamily \#include $<$pthread.\-h$>$}\\*
{\ttfamily \#include $<$math.\-h$>$}\\*
{\ttfamily \#include $<$float.\-h$>$}\\*
{\ttfamily \#include $<$string.\-h$>$}\\*
{\ttfamily \#include \char`\"{}../config.\-h\char`\"{}}\\*
{\ttfamily \#include $<$omp.\-h$>$}\\*
{\ttfamily \#include \char`\"{}cycle.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}errs.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}fptype.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}lock.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}part.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}cell.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}space.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}potential.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}runner.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}bond.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}rigid.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}angle.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}dihedral.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}exclusion.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}reader.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}engine.\-h\char`\"{}}\\*
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{engine__rigid_8c_a7673862d447029edaf3172ebd94aa28e}{error}(\hyperlink{errs_8c_a7441ef0865bcb3db9b8064dd7375c1ea}{id})~( \hyperlink{engine_8h_a3724bd1c34d31c4ff37eaff52dc0a580}{engine\-\_\-err} = \hyperlink{errs_8h_ae37a9c0e0a0aa4a92dbe64c0f38ed95c}{errs\-\_\-register}( \hyperlink{errs_8c_a7441ef0865bcb3db9b8064dd7375c1ea}{id} , \hyperlink{engine_8h_aa489083c5e5d436bafd05a7860b21804}{engine\-\_\-err\-\_\-msg}\mbox{[}-\/(\hyperlink{errs_8c_a7441ef0865bcb3db9b8064dd7375c1ea}{id})\mbox{]} , \-\_\-\-\_\-\-L\-I\-N\-E\-\_\-\-\_\- , \-\_\-\-\_\-\-F\-U\-N\-C\-T\-I\-O\-N\-\_\-\-\_\- , \-\_\-\-\_\-\-F\-I\-L\-E\-\_\-\-\_\- ) )
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{engine__rigid_8c_a6f09206374580e9eeef8c16dea4419f3}{engine\-\_\-rigid\-\_\-add} (struct \hyperlink{structengine}{engine} $\ast$\hyperlink{potential__eval_8h_ac54d1391e6657558123088943f721021}{e}, int pid, int pjd, double d)
\begin{DoxyCompactList}\small\item\em Add a rigid constraint to the engine. \end{DoxyCompactList}\item 
int \hyperlink{engine__rigid_8c_a0c8bedfc38955b879b7db720ebb896f9}{engine\-\_\-rigid\-\_\-unsort} (struct \hyperlink{structengine}{engine} $\ast$\hyperlink{potential__eval_8h_ac54d1391e6657558123088943f721021}{e})
\begin{DoxyCompactList}\small\item\em Shuffle the rigid constraints randomly. \end{DoxyCompactList}\item 
int \hyperlink{engine__rigid_8c_aaa4ca8f891331f7c68bd5770b63aa341}{engine\-\_\-rigid\-\_\-sort} (struct \hyperlink{structengine}{engine} $\ast$\hyperlink{potential__eval_8h_ac54d1391e6657558123088943f721021}{e})
\begin{DoxyCompactList}\small\item\em Split the rigids into local, semilocal and non-\/local. \end{DoxyCompactList}\item 
int \hyperlink{engine__rigid_8c_a3aab981531b097b166448a23f234eaf4}{engine\-\_\-rigid\-\_\-eval} (struct \hyperlink{structengine}{engine} $\ast$\hyperlink{potential__eval_8h_ac54d1391e6657558123088943f721021}{e})
\begin{DoxyCompactList}\small\item\em Resolve the constraints. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Macro Definition Documentation}
\hypertarget{engine__rigid_8c_a7673862d447029edaf3172ebd94aa28e}{\index{engine\-\_\-rigid.\-c@{engine\-\_\-rigid.\-c}!error@{error}}
\index{error@{error}!engine_rigid.c@{engine\-\_\-rigid.\-c}}
\subsubsection[{error}]{\setlength{\rightskip}{0pt plus 5cm}\#define error(
\begin{DoxyParamCaption}
\item[{}]{{\bf id}}
\end{DoxyParamCaption}
)~( {\bf engine\-\_\-err} = {\bf errs\-\_\-register}( {\bf id} , {\bf engine\-\_\-err\-\_\-msg}\mbox{[}-\/({\bf id})\mbox{]} , \-\_\-\-\_\-\-L\-I\-N\-E\-\_\-\-\_\- , \-\_\-\-\_\-\-F\-U\-N\-C\-T\-I\-O\-N\-\_\-\-\_\- , \-\_\-\-\_\-\-F\-I\-L\-E\-\_\-\-\_\- ) )}}\label{engine__rigid_8c_a7673862d447029edaf3172ebd94aa28e}


\subsection{Function Documentation}
\hypertarget{engine__rigid_8c_a6f09206374580e9eeef8c16dea4419f3}{\index{engine\-\_\-rigid.\-c@{engine\-\_\-rigid.\-c}!engine\-\_\-rigid\-\_\-add@{engine\-\_\-rigid\-\_\-add}}
\index{engine\-\_\-rigid\-\_\-add@{engine\-\_\-rigid\-\_\-add}!engine_rigid.c@{engine\-\_\-rigid.\-c}}
\subsubsection[{engine\-\_\-rigid\-\_\-add}]{\setlength{\rightskip}{0pt plus 5cm}int engine\-\_\-rigid\-\_\-add (
\begin{DoxyParamCaption}
\item[{struct {\bf engine} $\ast$}]{e, }
\item[{int}]{pid, }
\item[{int}]{pjd, }
\item[{double}]{d}
\end{DoxyParamCaption}
)}}\label{engine__rigid_8c_a6f09206374580e9eeef8c16dea4419f3}


Add a rigid constraint to the engine. 


\begin{DoxyParams}{Parameters}
{\em e} & The \hyperlink{structengine}{engine}. \\
\hline
{\em pid} & The I\-D of the first \hyperlink{structpart}{part}. \\
\hline
{\em pjd} & The I\-D of the second \hyperlink{structpart}{part}.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The index of the rigid constraint or $<$ 0 on error (see \hyperlink{engine_8h_a3724bd1c34d31c4ff37eaff52dc0a580}{engine\-\_\-err}).
\end{DoxyReturn}
Beware that currently all particles have to have been inserted before the rigid constraints are added! \hypertarget{engine__rigid_8c_a3aab981531b097b166448a23f234eaf4}{\index{engine\-\_\-rigid.\-c@{engine\-\_\-rigid.\-c}!engine\-\_\-rigid\-\_\-eval@{engine\-\_\-rigid\-\_\-eval}}
\index{engine\-\_\-rigid\-\_\-eval@{engine\-\_\-rigid\-\_\-eval}!engine_rigid.c@{engine\-\_\-rigid.\-c}}
\subsubsection[{engine\-\_\-rigid\-\_\-eval}]{\setlength{\rightskip}{0pt plus 5cm}int engine\-\_\-rigid\-\_\-eval (
\begin{DoxyParamCaption}
\item[{struct {\bf engine} $\ast$}]{e}
\end{DoxyParamCaption}
)}}\label{engine__rigid_8c_a3aab981531b097b166448a23f234eaf4}


Resolve the constraints. 


\begin{DoxyParams}{Parameters}
{\em e} & The \hyperlink{structengine}{engine}.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
\hyperlink{engine_8h_ad7d40017c544c2eb7cbf82cbbc9d45e0}{engine\-\_\-err\-\_\-ok} or $<$ 0 on error (see \hyperlink{engine_8h_a3724bd1c34d31c4ff37eaff52dc0a580}{engine\-\_\-err}).
\end{DoxyReturn}
Note that if in parallel, \hyperlink{engine__rigid_8c_aaa4ca8f891331f7c68bd5770b63aa341}{engine\-\_\-rigid\-\_\-sort} should be called before this routine. \hypertarget{engine__rigid_8c_aaa4ca8f891331f7c68bd5770b63aa341}{\index{engine\-\_\-rigid.\-c@{engine\-\_\-rigid.\-c}!engine\-\_\-rigid\-\_\-sort@{engine\-\_\-rigid\-\_\-sort}}
\index{engine\-\_\-rigid\-\_\-sort@{engine\-\_\-rigid\-\_\-sort}!engine_rigid.c@{engine\-\_\-rigid.\-c}}
\subsubsection[{engine\-\_\-rigid\-\_\-sort}]{\setlength{\rightskip}{0pt plus 5cm}int engine\-\_\-rigid\-\_\-sort (
\begin{DoxyParamCaption}
\item[{struct {\bf engine} $\ast$}]{e}
\end{DoxyParamCaption}
)}}\label{engine__rigid_8c_aaa4ca8f891331f7c68bd5770b63aa341}


Split the rigids into local, semilocal and non-\/local. 


\begin{DoxyParams}{Parameters}
{\em e} & The \hyperlink{structengine}{engine}.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
\hyperlink{engine_8h_ad7d40017c544c2eb7cbf82cbbc9d45e0}{engine\-\_\-err\-\_\-ok} or $<$ 0 on error (see \hyperlink{engine_8h_a3724bd1c34d31c4ff37eaff52dc0a580}{engine\-\_\-err}). 
\end{DoxyReturn}
\hypertarget{engine__rigid_8c_a0c8bedfc38955b879b7db720ebb896f9}{\index{engine\-\_\-rigid.\-c@{engine\-\_\-rigid.\-c}!engine\-\_\-rigid\-\_\-unsort@{engine\-\_\-rigid\-\_\-unsort}}
\index{engine\-\_\-rigid\-\_\-unsort@{engine\-\_\-rigid\-\_\-unsort}!engine_rigid.c@{engine\-\_\-rigid.\-c}}
\subsubsection[{engine\-\_\-rigid\-\_\-unsort}]{\setlength{\rightskip}{0pt plus 5cm}int engine\-\_\-rigid\-\_\-unsort (
\begin{DoxyParamCaption}
\item[{struct {\bf engine} $\ast$}]{e}
\end{DoxyParamCaption}
)}}\label{engine__rigid_8c_a0c8bedfc38955b879b7db720ebb896f9}


Shuffle the rigid constraints randomly. 


\begin{DoxyParams}{Parameters}
{\em e} & The \hyperlink{structengine}{engine}.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
\hyperlink{engine_8h_ad7d40017c544c2eb7cbf82cbbc9d45e0}{engine\-\_\-err\-\_\-ok} or $<$ 0 on error (see \hyperlink{engine_8h_a3724bd1c34d31c4ff37eaff52dc0a580}{engine\-\_\-err}). 
\end{DoxyReturn}
